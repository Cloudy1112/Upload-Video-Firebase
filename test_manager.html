<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Manager Dashboard Giả Lập</title>
    <script src="https://cdn.socket.io/4.6.0/socket.io.min.js"></script>
</head>
<body>
    <h2>Manager Support Dashboard</h2>
    <input type="text" id="roomId" placeholder="Nhập ID Khách (VD: guest_...)" style="width: 300px;">
    <button onclick="joinRoom()">Vào phòng chat</button>
    <br><br>
    <div id="chat-box" style="border: 1px solid #ccc; height: 300px; overflow-y: scroll; padding: 10px;"></div>
    <br>
    <input type="text" id="msgInput" placeholder="Nhập tin nhắn...">
    <button onclick="sendMsg()">Gửi</button>

    <script>
        // Kết nối tới Server localhost
        const socket = io("http://localhost:3000");

        socket.on("connect", () => {
            console.log("Manager đã kết nối: " + socket.id);
        });

        // Nghe tin nhắn từ Android gửi tới
        socket.on("receive_message", (data) => {
            const box = document.getElementById("chat-box");
            box.innerHTML += `<p style="color: blue;"><strong>Khách:</strong> ${data.content}</p>`;
        });

        function joinRoom() {
            const room = document.getElementById("roomId").value;
            if(room) {
                socket.emit("join_room", room);
                alert("Đã vào phòng: " + room);
            }
        }

        function sendMsg() {
            const room = document.getElementById("roomId").value;
            const content = document.getElementById("msgInput").value;
            
            const data = {
                room: room,
                content: content,
                sender: "Manager"
            };

            // Gửi tin nhắn xuống Server
            socket.emit("send_message", data);

            // Hiện lên màn hình mình
            const box = document.getElementById("chat-box");
            box.innerHTML += `<p style="color: green; text-align: right;"><strong>Me:</strong> ${content}</p>`;
        }
    </script>
</body>
</html>